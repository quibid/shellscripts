#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -o /home/sjhadmin/bin/prog -f ./prog 
#endif

static  char data [] = 
#define      pswd_z	256
#define      pswd	((&data[27]))
	"\025\311\014\050\224\021\075\326\064\350\246\200\076\104\005\364"
	"\050\343\207\062\320\134\270\127\071\232\237\323\026\104\356\256"
	"\013\340\171\161\011\153\146\155\062\015\213\322\225\257\206\351"
	"\255\330\121\162\135\315\270\322\332\067\246\360\173\224\237\207"
	"\165\031\371\176\205\137\354\267\154\170\212\001\047\020\353\324"
	"\350\074\106\106\011\377\031\344\066\277\324\262\123\164\071\311"
	"\215\062\110\022\222\064\311\376\254\124\000\324\145\353\250\115"
	"\050\357\224\061\356\255\025\044\154\352\327\300\136\020\211\354"
	"\102\321\376\324\006\310\323\262\035\324\207\202\300\057\320\350"
	"\036\144\031\015\022\057\062\177\032\011\100\171\031\311\145\134"
	"\233\144\061\241\055\005\124\112\331\333\314\231\013\234\202\051"
	"\001\234\067\024\313\151\223\346\162\324\140\214\235\305\351\071"
	"\052\033\333\127\040\057\242\372\013\156\224\026\013\026\100\015"
	"\262\167\042\176\341\265\145\124\211\305\341\047\213\312\141\265"
	"\346\074\015\006\153\257\001\167\036\225\215\051\254\316\067\136"
	"\105\131\335\046\017\102\173\231\007\134\301\222\046\042\110\014"
	"\136\125\023\312\004\024\102\042\252\317\114\126\235\204\265\343"
	"\335\222\012\355\325\205\206\334\341\110\157\250\243\012\140\270"
	"\324\155\341\150\176\037\077\262\007\345\063\106\052\070\072\122"
	"\033\301\205\353\036\075\103\127\330\342\377\173\355\137\064\301"
	"\314\025\051\113\064\150\376\074\116"
#define      date_z	1
#define      date	((&data[329]))
	"\047"
#define      lsto_z	1
#define      lsto	((&data[330]))
	"\373"
#define      tst1_z	22
#define      tst1	((&data[334]))
	"\161\236\215\171\135\137\114\273\131\150\241\322\247\014\303\027"
	"\205\312\125\231\172\162\363\141\264\265"
#define      chk2_z	19
#define      chk2	((&data[358]))
	"\365\054\215\315\101\115\124\026\075\215\070\146\171\165\155\157"
	"\016\160\351\310\341\205"
#define      inlo_z	3
#define      inlo	((&data[379]))
	"\241\016\154"
#define      msg1_z	65
#define      msg1	((&data[384]))
	"\155\140\224\333\007\040\070\140\106\072\230\105\127\347\360\261"
	"\075\221\365\354\266\063\376\036\273\217\071\347\243\371\272\353"
	"\367\276\000\300\326\152\004\030\264\073\122\044\146\306\262\312"
	"\031\127\002\177\354\133\047\200\155\163\075\311\052\232\121\006"
	"\260\325\275\331\153\235\047\235\040\240"
#define      shll_z	10
#define      shll	((&data[458]))
	"\215\136\340\035\034\051\235\062\271\253\252\274\272"
#define      xecc_z	15
#define      xecc	((&data[472]))
	"\263\362\257\041\074\160\036\130\066\357\230\262\227\344\367\127"
	"\150\010\113"
#define      tst2_z	19
#define      tst2	((&data[490]))
	"\074\247\235\011\334\360\072\042\054\313\114\367\236\154\170\026"
	"\317\077\261\274\313\027\136\322\210"
#define      opts_z	1
#define      opts	((&data[513]))
	"\243"
#define      chk1_z	22
#define      chk1	((&data[518]))
	"\325\361\051\334\075\300\251\224\026\003\153\245\041\255\375\025"
	"\040\125\032\212\015\123\051\066\330\333\317\224\151"
#define      msg2_z	19
#define      msg2	((&data[544]))
	"\052\156\305\376\330\310\120\207\001\205\240\060\060\346\143\367"
	"\153\373\362\163\230\034"
#define      rlax_z	1
#define      rlax	((&data[565]))
	"\276"
#define      text_z	6272
#define      text	((&data[1893]))
	"\100\177\121\237\122\332\153\206\073\243\127\305\170\110\356\125"
	"\027\203\276\105\322\047\160\153\104\214\262\255\220\213\347\321"
	"\012\071\160\135\023\333\344\117\177\073\024\367\203\003\114\233"
	"\206\013\340\131\063\120\304\167\335\167\044\156\002\014\100\015"
	"\105\260\152\130\214\116\247\014\212\273\003\015\277\120\250\105"
	"\133\211\236\217\332\143\006\270\332\053\046\334\067\147\351\175"
	"\030\124\325\245\243\175\261\055\070\264\073\370\005\343\075\141"
	"\155\334\360\107\077\366\377\032\042\046\367\132\216\341\327\246"
	"\065\255\113\331\052\374\007\143\261\102\133\267\046\230\030\223"
	"\165\010\333\265\377\333\317\041\001\307\174\217\250\124\066\336"
	"\001\201\267\053\176\277\216\060\001\352\347\047\202\377\273\370"
	"\007\226\255\007\161\175\050\163\104\245\003\355\371\071\313\373"
	"\273\203\046\071\102\265\152\103\237\121\153\042\121\046\032\131"
	"\275\310\140\056\106\211\242\212\056\245\167\050\337\102\043\232"
	"\306\111\324\010\377\076\114\236\220\267\301\341\336\334\073\233"
	"\244\233\312\352\044\154\165\123\022\355\173\361\057\236\214\366"
	"\350\141\376\350\240\112\206\060\001\110\022\340\044\115\173\311"
	"\351\105\263\015\262\051\140\304\026\333\265\106\172\102\074\143"
	"\243\072\113\103\204\322\163\206\032\206\146\076\324\342\007\275"
	"\047\273\312\331\344\053\236\372\007\123\100\201\225\174\344\071"
	"\267\057\174\074\001\360\303\034\167\051\132\113\014\142\011\063"
	"\035\324\015\002\377\253\375\006\377\075\207\225\272\154\316\161"
	"\234\113\255\236\073\161\272\262\232\024\376\247\167\007\333\225"
	"\333\351\227\332\224\224\341\224\322\150\052\214\325\371\376\161"
	"\104\254\017\200\035\311\062\270\336\061\137\125\070\072\352\024"
	"\043\202\357\270\027\320\115\351\071\167\166\016\161\164\177\265"
	"\041\217\065\076\130\150\366\067\231\126\215\322\221\170\346\265"
	"\372\325\155\022\246\273\373\337\062\162\355\243\347\155\131\010"
	"\374\217\106\125\367\075\215\221\224\032\144\045\222\113\332\215"
	"\041\110\237\307\003\233\246\065\015\224\331\364\001\063\374\376"
	"\302\103\124\271\201\341\113\025\374\257\072\216\372\025\033\034"
	"\135\273\343\140\126\212\226\144\036\160\130\037\243\125\036\145"
	"\231\162\037\032\124\153\057\120\032\152\337\025\177\372\061\334"
	"\266\025\075\014\237\323\161\275\103\311\335\347\037\373\114\270"
	"\156\154\322\303\327\002\023\361\154\362\007\353\355\071\310\244"
	"\116\005\261\356\331\042\253\035\354\211\004\013\205\121\304\364"
	"\275\226\267\224\230\313\206\005\276\215\360\254\307\271\120\026"
	"\277\001\004\230\043\260\266\017\071\272\033\277\013\337\263\310"
	"\165\152\135\016\066\343\023\364\160\004\240\070\275\360\116\175"
	"\362\122\026\025\003\314\045\075\207\100\374\223\037\257\134\225"
	"\032\271\243\120\234\266\104\014\273\345\105\171\326\223\366\310"
	"\346\014\336\351\331\003\046\140\104\042\363\143\322\120\370\354"
	"\011\234\074\245\123\201\262\016\147\367\207\075\212\175\006\161"
	"\212\345\132\143\351\201\304\055\243\270\221\166\010\211\142\022"
	"\045\237\267\170\041\152\207\210\141\016\306\354\214\315\135\027"
	"\262\270\173\233\071\077\311\335\370\132\123\001\344\265\023\011"
	"\125\312\202\166\065\011\376\226\030\304\203\245\221\341\274\104"
	"\231\067\340\322\167\251\260\160\003\003\161\347\271\204\361\016"
	"\117\164\204\204\176\203\033\227\107\236\074\331\177\371\036\031"
	"\061\376\354\250\247\234\031\253\237\212\223\130\017\205\147\136"
	"\372\353\343\170\157\376\017\266\235\114\220\034\105\256\066\166"
	"\254\042\037\124\276\070\000\136\302\224\266\322\031\036\060\023"
	"\012\023\214\171\022\234\060\257\350\300\314\055\157\002\243\034"
	"\044\302\160\342\372\161\100\275\005\367\217\037\026\300\063\040"
	"\324\277\231\346\133\312\225\103\212\141\161\372\143\024\026\207"
	"\327\207\152\321\370\253\217\375\243\037\035\271\337\120\331\263"
	"\017\163\231\153\075\057\257\310\220\040\302\363\064\331\173\014"
	"\140\346\335\130\222\155\126\065\214\163\357\154\303\311\040\323"
	"\074\272\076\172\351\356\103\171\016\006\155\103\337\351\117\077"
	"\320\055\227\142\233\356\230\050\141\207\225\045\120\265\371\215"
	"\157\070\010\131\046\113\323\065\121\101\170\060\053\310\157\373"
	"\366\007\136\221\366\366\272\130\176\117\175\317\004\167\134\164"
	"\257\144\315\325\257\240\012\001\341\203\061\015\114\241\010\102"
	"\251\147\324\240\136\216\370\334\335\166\253\341\355\010\126\234"
	"\154\043\162\034\304\174\036\246\000\120\263\114\361\274\216\233"
	"\043\143\074\201\361\064\135\316\253\011\260\230\021\006\065\176"
	"\052\247\232\357\044\270\225\045\010\111\161\372\005\000\226\050"
	"\143\322\251\124\007\007\043\262\021\324\112\043\332\200\241\005"
	"\047\074\364\114\365\211\161\376\322\343\371\330\343\217\000\107"
	"\142\252\234\151\262\277\034\303\223\147\346\156\347\210\163\017"
	"\304\147\134\271\361\315\270\304\261\261\234\224\101\235\334\243"
	"\107\170\015\372\070\051\275\314\221\244\073\170\055\257\210\361"
	"\027\344\253\010\262\143\315\143\024\151\370\125\006\324\371\116"
	"\114\006\110\205\060\006\122\301\253\215\072\330\074\302\311\123"
	"\246\165\134\130\330\051\274\355\223\264\103\232\210\074\350\325"
	"\103\061\132\163\067\255\065\343\072\157\273\166\062\205\312\330"
	"\372\046\061\323\117\355\300\343\241\003\175\052\100\145\377\203"
	"\227\132\367\317\007\054\262\102\234\156\270\317\363\203\250\356"
	"\251\331\302\371\307\203\334\151\207\131\224\307\277\223\112\126"
	"\356\102\045\366\157\327\070\014\105\361\333\071\164\203\050\035"
	"\135\352\026\044\155\363\216\364\114\042\274\013\266\007\141\245"
	"\111\206\233\270\136\324\305\244\305\240\335\071\043\006\127\200"
	"\360\156\245\136\141\064\122\255\127\016\271\016\026\032\263\307"
	"\001\177\351\050\265\205\337\203\353\262\371\152\270\045\354\247"
	"\371\213\016\002\251\304\105\255\101\035\251\333\322\136\133\046"
	"\210\150\127\050\320\012\255\365\366\003\200\015\175\162\074\110"
	"\303\057\136\026\326\264\356\051\030\027\061\212\041\335\117\331"
	"\017\266\313\371\007\134\254\045\361\136\131\152\207\111\057\047"
	"\216\133\110\110\316\361\373\274\050\073\152\020\101\223\031\030"
	"\250\324\167\311\247\037\240\320\056\360\245\100\170\324\114\260"
	"\150\307\250\322\303\344\242\123\217\155\001\260\032\005\126\071"
	"\026\007\222\341\267\070\047\142\213\011\147\272\014\262\066\217"
	"\254\352\107\221\276\336\254\261\031\021\266\011\270\020\132\201"
	"\271\146\140\301\330\202\243\266\333\275\023\202\335\350\212\077"
	"\051\030\313\310\100\035\003\343\246\060\142\377\203\031\177\251"
	"\076\100\053\332\310\133\014\265\047\275\021\230\150\110\056\334"
	"\234\273\114\013\206\163\325\356\054\131\257\150\003\353\305\367"
	"\111\354\045\353\243\153\322\124\041\361\340\351\364\324\017\304"
	"\107\117\162\315\362\235\176\221\276\263\277\213\256\306\072\057"
	"\256\042\273\322\333\102\234\245\371\246\007\212\243\237\375\260"
	"\270\121\317\332\001\355\256\121\115\177\335\321\342\311\105\332"
	"\234\306\374\232\222\322\350\265\345\103\272\341\347\026\322\320"
	"\220\332\344\005\267\134\245\354\136\051\254\052\034\065\254\146"
	"\311\213\234\314\074\316\261\363\230\344\130\243\222\130\076\143"
	"\134\321\204\162\202\006\107\370\107\070\241\202\272\263\254\033"
	"\221\157\002\364\352\051\105\361\066\362\352\162\070\331\134\231"
	"\072\333\026\307\373\041\177\153\243\102\175\040\211\346\160\266"
	"\176\035\264\076\015\143\117\236\373\363\212\002\011\366\057\204"
	"\024\376\203\005\346\100\277\171\261\314\150\365\340\201\236\142"
	"\265\231\116\260\331\106\162\143\302\324\241\115\340\157\200\231"
	"\022\011\015\150\375\157\153\176\311\171\271\307\043\011\171\133"
	"\227\064\260\321\335\210\156\206\265\136\147\157\165\242\063\145"
	"\057\062\302\367\237\124\036\111\041\002\014\332\075\077\133\333"
	"\314\350\210\376\331\205\224\211\352\261\021\244\224\107\151\007"
	"\170\055\135\232\140\106\344\052\076\040\274\313\277\265\132\015"
	"\074\231\374\156\300\353\075\310\124\145\251\067\333\013\045\210"
	"\056\221\377\053\160\020\254\304\040\352\273\312\027\043\262\224"
	"\364\140\155\343\046\311\125\171\361\154\205\141\100\136\211\174"
	"\265\164\025\003\331\053\061\226\167\220\241\141\023\216\132\172"
	"\036\230\061\141\201\131\156\277\217\236\036\361\103\211\003\232"
	"\175\313\136\040\074\346\321\013\340\167\003\220\024\170\153\234"
	"\225\060\151\036\120\041\230\052\207\242\242\324\071\131\203\204"
	"\362\117\225\142\016\147\150\141\341\217\007\265\257\104\247\247"
	"\135\152\051\260\122\050\221\345\266\065\362\303\322\116\025\203"
	"\244\360\360\326\334\126\107\244\374\042\250\160\214\347\015\344"
	"\366\161\103\251\156\251\153\175\325\347\261\304\272\123\170\255"
	"\350\320\257\105\174\076\100\034\142\203\141\165\336\117\047\367"
	"\211\047\311\017\163\351\067\354\047\060\005\062\012\164\370\216"
	"\375\030\117\275\333\231\326\051\004\050\360\173\155\302\141\014"
	"\206\336\211\224\053\245\327\065\344\235\030\011\325\257\072\052"
	"\351\376\126\117\213\204\244\167\332\063\361\376\122\270\000\312"
	"\251\067\030\142\377\256\334\320\365\077\132\275\036\174\125\213"
	"\027\032\300\371\250\363\101\041\061\134\122\124\365\100\160\323"
	"\364\325\031\312\155\212\355\074\155\254\167\161\163\037\305\121"
	"\241\324\277\043\166\253\000\030\003\255\273\152\363\356\062\211"
	"\212\354\215\357\257\077\337\024\175\002\202\136\335\175\255\126"
	"\247\272\254\226\313\102\275\051\342\162\233\246\143\160\114\154"
	"\000\002\037\301\337\127\344\232\271\225\125\210\364\050\030\315"
	"\345\222\132\274\171\276\101\340\256\214\020\067\164\223\230\057"
	"\220\045\345\322\357\360\127\233\350\224\105\375\040\321\314\155"
	"\212\341\321\317\326\047\255\054\226\324\004\016\046\345\324\351"
	"\221\166\345\261\057\361\051\220\267\363\006\221\145\346\106\117"
	"\142\225\351\107\376\350\351\105\224\315\240\213\040\341\046\261"
	"\301\156\360\052\000\034\105\215\173\357\217\376\051\345\075\205"
	"\056\010\106\057\322\044\252\237\055\023\251\057\026\000\011\066"
	"\307\165\102\244\052\307\325\016\072\065\035\134\172\254\131\202"
	"\020\366\021\326\122\313\273\207\124\255\171\002\176\337\034\054"
	"\321\300\220\166\010\030\243\316\312\364\331\244\333\351\103\144"
	"\237\340\070\246\325\036\340\073\055\075\104\052\072\160\142\221"
	"\142\140\340\334\210\226\262\231\013\000\304\277\125\204\112\127"
	"\311\021\006\037\226\246\216\120\205\171\067\241\025\303\030\017"
	"\276\364\254\254\255\320\365\301\263\153\027\043\171\011\141\167"
	"\044\026\150\062\051\322\006\156\230\016\325\032\324\024\166\373"
	"\064\310\240\371\015\356\233\275\010\116\067\342\062\121\137\120"
	"\000\046\052\321\014\333\330\212\026\024\311\141\060\052\336\056"
	"\267\053\264\007\013\016\046\364\167\265\154\022\171\162\031\243"
	"\160\316\314\054\236\043\150\307\014\173\004\154\144\370\060\321"
	"\144\354\250\354\275\325\055\145\061\375\277\317\373\304\350\244"
	"\030\123\165\235\235\011\342\002\257\273\112\017\242\200\352\065"
	"\215\230\275\321\070\347\127\155\226\330\013\170\200\307\273\006"
	"\303\152\300\341\125\104\222\037\123\204\372\067\261\074\007\172"
	"\042\331\262\163\077\337\320\245\005\051\313\363\267\242\130\213"
	"\051\061\150\242\245\174\307\123\356\311\335\127\260\020\311\301"
	"\305\132\074\304\164\255\316\225\175\324\317\006\024\224\375\176"
	"\267\140\046\267\045\130\166\203\005\371\152\241\311\112\252\263"
	"\214\041\261\256\075\365\336\366\301\067\211\055\332\344\203\242"
	"\076\200\150\251\334\246\141\135\003\077\322\060\371\236\156\021"
	"\166\377\127\266\236\302\205\237\166\374\227\070\305\336\344\216"
	"\260\271\351\100\375\024\012\170\032\232\257\173\301\206\052\217"
	"\233\367\354\326\064\055\357\113\223\346\032\307\056\022\043\376"
	"\340\300\161\346\362\132\106\121\300\006\214\202\217\351\343\166"
	"\120\374\256\173\017\263\367\345\146\244\203\232\050\356\252\316"
	"\266\047\011\303\041\231\010\221\363\276\061\371\316\020\111\254"
	"\111\274\142\170\304\111\114\220\371\366\167\270\300\165\316\155"
	"\043\237\357\061\116\034\116\103\211\013\120\070\126\176\343\212"
	"\055\166\313\051\010\040\054\100\160\134\202\203\160\245\354\071"
	"\076\046\054\142\322\345\256\264\266\121\021\002\251\027\036\012"
	"\226\320\333\216\163\115\060\126\126\315\240\113\234\251\141\376"
	"\317\047\360\216\042\364\112\177\303\270\314\037\353\234\253\331"
	"\261\176\271\156\121\233\207\142\065\344\176\266\037\344\345\133"
	"\176\375\075\217\075\313\131\106\277\227\127\117\253\342\341\042"
	"\000\330\277\060\150\134\233\364\053\116\231\250\123\005\235\142"
	"\305\316\066\374\002\225\037\017\135\257\174\023\354\075\166\203"
	"\161\210\030\001\051\152\261\356\331\041\110\074\126\056\125\022"
	"\332\150\205\351\001\066\013\146\376\074\224\123\370\102\305\042"
	"\165\312\347\137\127\231\015\114\015\064\123\323\200\034\001\254"
	"\374\344\236\075\045\117\175\024\351\362\305\275\114\371\021\377"
	"\314\145\123\126\214\363\345\075\302\352\116\377\017\124\206\226"
	"\371\365\226\035\116\134\252\217\153\010\040\234\044\001\136\000"
	"\331\201\106\325\066\254\373\021\326\123\212\002\315\375\324\213"
	"\357\070\232\271\274\333\130\125\372\067\102\224\136\144\355\171"
	"\100\250\146\233\123\254\145\075\135\234\364\345\261\173\253\073"
	"\123\172\323\137\166\222\304\131\023\215\314\377\100\204\132\215"
	"\346\161\001\352\267\316\321\047\215\156\077\110\144\101\114\346"
	"\255\062\340\041\264\275\217\272\302\322\143\076\371\036\136\034"
	"\121\361\034\154\003\355\171\241\055\236\172\215\016\166\126\237"
	"\010\353\240\300\124\333\337\175\305\060\110\360\370\210\072\230"
	"\234\372\113\145\164\041\352\247\151\102\110\040\122\372\333\204"
	"\254\230\235\240\301\155\312\346\352\164\360\123\052\134\137\060"
	"\221\151\341\301\056\364\036\112\134\150\074\030\244\241\124\163"
	"\052\164\024\374\045\136\200\357\143\373\022\337\013\237\245\225"
	"\174\056\072\212\132\130\067\144\104\220\057\362\332\324\233\235"
	"\156\121\261\355\337\370\305\007\101\354\056\233\024\042\066\161"
	"\150\002\225\005\263\204\110\004\200\245\370\371\363\245\106\017"
	"\072\161\346\255\266\210\202\157\130\332\164\070\146\164\255\060"
	"\370\001\213\302\122\136\214\346\204\166\206\252\363\143\124\367"
	"\262\301\016\307\347\235\133\321\036\104\211\353\022\347\302\317"
	"\041\363\223\360\246\061\046\121\230\320\033\172\360\237\122\007"
	"\355\361\366\354\216\347\014\317\220\144\103\227\202\351\020\130"
	"\251\224\047\045\360\022\102\122\204\317\146\211\145\175\143\253"
	"\231\107\353\130\207\255\255\170\357\264\012\356\356\365\322\023"
	"\221\244\000\155\370\102\213\105\342\072\163\100\217\237\155\357"
	"\372\104\324\267\165\214\155\172\214\267\276\113\345\043\260\167"
	"\206\107\323\113\027\342\363\057\125\137\034\353\141\374\124\052"
	"\233\165\362\041\252\221\163\351\104\234\107\337\147\373\011\333"
	"\005\065\335\311\364\274\005\165\107\217\247\047\266\223\162\170"
	"\333\072\266\355\172\273\120\014\117\001\277\326\136\217\001\117"
	"\160\055\244\351\362\223\065\010\354\337\055\033\022\322\063\273"
	"\056\073\034\106\126\024\142\303\371\367\177\254\335\147\333\357"
	"\227\205\330\051\045\046\064\377\007\157\356\330\326\147\232\360"
	"\270\322\334\151\245\171\274\262\132\077\205\046\215\007\357\205"
	"\020\315\156\151\120\117\174\033\073\116\020\311\274\374\301\262"
	"\030\277\057\061\140\041\272\211\227\007\333\267\350\112\135\323"
	"\357\217\233\044\343\221\331\273\321\211\006\134\207\260\340\025"
	"\312\273\124\357\265\110\132\262\346\014\066\003\032\273\027\353"
	"\025\277\065\215\011\236\147\132\107\063\020\077\167\370\317\341"
	"\147\036\377\310\260\360\356\071\034\265\372\105\026\372\240\247"
	"\071\223\373\241\043\263\141\373\266\023\074\172\112\332\343\014"
	"\315\365\343\375\006\206\322\033\126\005\321\216\230\321\073\014"
	"\342\003\041\142\351\006\125\371\325\351\211\237\000\151\035\034"
	"\362\101\323\341\005\173\310\361\131\341\200\174\277\376\341\024"
	"\256\364\333\046\157\053\014\306\166\131\326\160\047\010\054\056"
	"\013\362\314\316\030\336\321\343\214\005\165\123\172\207\353\211"
	"\261\256\017\057\055\225\342\217\061\371\164\207\362\236\253\205"
	"\146\375\257\236\125\027\226\057\271\073\222\172\135\276\167\046"
	"\046\302\252\372\172\306\350\170\155\263\116\021\072\363\066\335"
	"\324\140\112\156\021\126\140\260\167\107\117\225\172\047\376\337"
	"\114\207\002\170\133\357\246\327\006\020\322\367\000\256\177\000"
	"\177\345\224\071\262\311\157\013\160\362\201\021\141\072\223\364"
	"\366\005\171\130\266\356\313\272\137\116\207\275\345\032\324\365"
	"\270\172\113\163\220\133\344\161\071\044\043\220\214\100\065\216"
	"\002\154\376\006\352\175\077\144\154\023\316\077\016\115\016\027"
	"\073\332\173\226\321\335\120\144\362\210\357\016\172\216\354\351"
	"\223\215\206\204\041\045\014\105\035\360\214\021\136\200\234\306"
	"\104\206\160\166\166\333\232\330\337\032\012\245\212\324\257\276"
	"\045\021\235\063\146\052\262\342\015\256\243\243\207\243\302\305"
	"\233\001\204\060\322\354\106\250\353\372\310\056\100\014\017\335"
	"\073\037\337\373\363\160\243\312\126\144\137\172\177\320\317\321"
	"\323\236\172\020\071\017\013\250\112\246\051\177\235\025\312\234"
	"\304\346\342\021\275\144\307\165\231\232\003\343\060\341\225\174"
	"\266\320\160\155\353\375\017\245\307\324\021\024\174\117\022\250"
	"\276\026\165\176\165\341\027\347\061\267\265\220\272\047\113\252"
	"\046\044\315\165\162\217\117\040\026\327\171\021\364\110\043\250"
	"\023\340\204\022\052\044\251\110\316\167\065\275\172\136\166\133"
	"\172\357\111\304\220\067\010\376\037\350\225\322\210\123\300\360"
	"\123\037\011\327\341\124\264\261\213\372\365\233\337\145\310\122"
	"\126\153\110\133\122\323\032\241\101\230\271\011\022\176\347\033"
	"\216\151\222\046\377\222\344\006\147\367\050\311\212\201\264\312"
	"\205\133\105\331\103\126\040\024\251\262\330\235\027\376\242\177"
	"\031\301\270\162\332\307\001\107\333\132\122\005\273\335\306\301"
	"\031\324\050\165\005\273\306\370\215\205\032\034\030\116\341\254"
	"\367\145\251\374\322\174\032\104\241\142\331\073\036\370\137\323"
	"\144\131\116\160\370\346\330\015\110\162\171\345\026\137\027\310"
	"\200\226\155\301\305\054\231\347\101\251\323\200\302\342\001\062"
	"\360\271\066\052\021\315\256\130\251\376\337\031\007\311\172\274"
	"\303\244\253\100\104\002\302\100\262\341\336\037\074\035\135\221"
	"\370\067\324\223\304\245\365\311\107\114\233\101\374\076\332\235"
	"\376\063\226\141\045\152\254\251\253\246\062\350\107\007\070\051"
	"\340\151\150\163\122\037\127\316\223\133\213\117\264\272\014\222"
	"\364\017\333\356\004\306\076\042\176\342\037\203\134\113\367\051"
	"\335\300\217\341\120\057\211\114\174\172\053\024\260\246\130\344"
	"\136\050\337\364\105\226\242\215\113\146\265\352\323\221\257\317"
	"\177\153\275\126\226\006\211\367\227\123\320\143\047\212\045\341"
	"\020\233\365\221\177\162\225\347\072\244\215\146\221\122\224\167"
	"\233\241\144\202\146\274\077\043\130\150\052\056\372\117\344\250"
	"\374\307\033\175\032\163\132\024\243\115\021\024\175\116\171\274"
	"\061\370\027\356\116\252\330\021\360\260\141\167\227\011\142\117"
	"\255\066\252\357\150\363\251\052\107\161\137\030\037\010\204\353"
	"\216\212\166\131\052\244\030\241\110\310\132\102\270\164\002\356"
	"\261\212\150\003\156\353\135\001\233\026\160\115\045\142\210\160"
	"\377\377\377\227\102\305\032\106\326\112\162\176\373\000\206\123"
	"\362\321\215\237\325\233\331\207\027\202\174\275\260\273\251\341"
	"\022\247\074\004\264\144\264\302\102\151\110\333\213\135\204\377"
	"\223\124\110\332\324\260\363\374\245\254\176\117\316\144\175\265"
	"\015\241\166\071\212\057\067\150\061\221\025\321\033\370\176\070"
	"\050\121\277\253\116\200\235\376\005\021\146\337\076\055\140\050"
	"\315\372\241\227\023\305\113\230\042\040\157\050\366\124\012\347"
	"\233\315\336\153\037\276\042\246\247\176\244\221\250\071\334\376"
	"\132\257\040\245\133\122\144\214\300\041\363\313\156\354\351\134"
	"\277\372\160\067\164\127\056\062\250\200\351\156\346\241\023\371"
	"\223\146\136\365\363\236\350\173\014\251\367\053\144\113\134\216"
	"\237\205\216\217\201\301\211\172\040\237\116\105\002\252\050\270"
	"\374\161\056\315\130\366\352\127\234\071\025\111\071\057\004\210"
	"\017\223\343\344\003\011\276\202\200\321\247\052\261\054\004\236"
	"\263\265\324\076\160\236\031\163\240\161\127\271\002\120\334\213"
	"\341\374\362\164\150\265\100\055\312\203\225\142\072\227\022\077"
	"\163\243\107\345\332\041\040\206\220\074\103\024\225\120\125\173"
	"\102\226\132\147\251\064\057\116\200\207\104\070\102\356\360\372"
	"\101\145\212\356\125\217\000\007\160\201\125\045\344\056\300\053"
	"\115\260\050\317\117\054\016\222\361\356\071\363\010\267\351\302"
	"\160\307\143\341\213\060\070\354\305\270\312\210\141\123\361\044"
	"\224\002\112\362\275\375\202\225\065\164\235\254\126\033\374\061"
	"\342\363\261\335\162\227\133\257\350\055\310\340\204\141\171\113"
	"\044\053\237\041\224\124\220\353\044\045\174\071\241\131\071\167"
	"\077\137\256\344\015\336\142\037\053\125\261\142\052\254\230\046"
	"\363\306\147\315\207\121\173\103\221\345\147\323\024\320\173\157"
	"\133\000\161\167\130\372\201\076\366\067\234\055\016\077\100\323"
	"\362\247\036\370\161\311\102\016\362\361\032\216\201\107\214\006"
	"\131\215\224\377\267\212\061\042\041\244\065\102\211\261\225\134"
	"\347\150\145\057\214\046\055\066\147\072\262\275\105\270\112\020"
	"\017\300\327\122\276\350\057\312\256\211\276\227\217\033\056\102"
	"\360\253\001\364\260\004\333\177\257\221\345\055\176\360\003\000"
	"\335\013\120\154\275\317\366\076\226\360\370\353\025\261\205\257"
	"\351\036\120\346\347\224\107\324\125\002\354\112\215\363\114\362"
	"\251\133\021\255\032\313\370\065\243\332\114\244\234\132\210\363"
	"\305\274\302\140\214\024\315\062\256\304\374\005\353\300\323\116"
	"\306\245\254\256\031\334\126\124\174\136\115\255\220\262\305\137"
	"\324\340\256\201\342\042\145\146\110\120\157\246\364\260\250\213"
	"\253\065\316\142\303\067\201\167\272\113\341\300\342\046\376\046"
	"\362\156\311\021\367\171\172\137\012\151\315\145\026\214\256\125"
	"\217\124\040\226\020\060\200\275\002\123\224\135\321\307\057\043"
	"\047\077\265\253\362\251\232\041\264\031\235\056\245\171\046\013"
	"\126\122\100\370\065\354\245\060\061\373\104\161\305\017\336\072"
	"\030\125\343\003\177\337\053\324\042\244\345\232\275\255\231\375"
	"\220\300\026\333\072\041\344\162\357\216\201\260\304\147\103\051"
	"\177\033\374\215\322\245\007\021\052\016\055\105\037\346\366\274"
	"\241\024\042\062\311\107\234\002\340\130\024\213\244\231\203\305"
	"\262\131\050\113\075\266\270\265\153\346\117\055\173\370\150\204"
	"\250\213\330\265\225\006\251\300\250\335\000\070\301\255\362\330"
	"\212\145\075\135\057\342\234\346\367\134\130\250\163\267\026\163"
	"\375\217\116\247\217\204\301\140\115\233\170\014\251\360\361\020"
	"\054\165\114\226\141\271\373\352\114\234\235\026\356\366\021\165"
	"\070\163\311\175\357\374\345\104\272\060\016\173\002\221\004\164"
	"\326\260\365\076\161\124\214\021\105\002\277\114\172\026\042\117"
	"\061\371\254\260\035\132\075\161\120\152\063\301\213\314\157\356"
	"\232\170\132\073\346\021\234\011\374\226\031\260\034\020\250\036"
	"\325\123\053\160\044\154\215\173\327\043\244\166\156\237\033\102"
	"\254\210\066\275\344\114\006\173\030\034\106\136\270\320\305\371"
	"\233\131\013\321\347\234\342\171\053\365\073\375\164\251\125\021"
	"\023\140\056\335\141\221\216\157\120\263\110\304\332\011\372\325"
	"\210\233\146\324\341\355\330\324\177\332\325\374\240\060\334\115"
	"\156\075\363\252\010\266\263\021\234\143\116\121\212\344\074\100"
	"\044\003\230\231\133\246\052\010\240\205\247\100\171\114\332\277"
	"\032\115\362\224\146\121\106\152\351\213\074\340\333\361\061\053"
	"\027\200\161\000\167\166\266\057\322\320\031\004\074\053\315\026"
	"\320\270\005\074\241\171\376\143\176\067\320\104\153\304\333\105"
	"\374\115\335\361\174\225\200\174\056\044\225\205\265\300\245\022"
	"\142\146\134\176\100\141\177\054\006\145\067\145\247\273\225\234"
	"\047\136\120\221\206\375\222\250\013\062\271\312\150\045\136\210"
	"\104\336\064\100\134\262\145\161\336\060\127\261\275\364\135\156"
	"\024\213\243\266\364\331\141\056\260\365\106\262\302\072\210\300"
	"\063\151\265\070\223\030\270\171\206\052\113\117\105\177\353\264"
	"\011\255\357\123\155\127\121\001\004\243\305\136\067\164\254\100"
	"\260\362\146\011\122\217\015\353\105\103\256\132\054\302\134\327"
	"\263\034\200\231\307\120\042\137\222\342\346\307\300\220\202\016"
	"\304\062\002\245\276\263\276\110\256\240\303\225\117\351\370\317"
	"\032\364\321\035\145\171\242\233\303\156\252\164\265\135\150\260"
	"\107\033\155\222\063\107\221\251\344\052\214\374\273\265\002\204"
	"\306\331\062\356\036\231\123\066\051\315\272\350\031\052\307\006"
	"\114\316\376\144\111\020\020\353\113\217\211\277\032\213\121\277"
	"\050\232\266\345\200\015\016\150\311\377\164\023\321\364\365\130"
	"\056\331\044\057\105\347\004\112\013\004\243\362\122\261\133\200"
	"\043\030\241\335\214\271\036\354\345\201\305\233\325\262\034\314"
	"\207\131\231\213\371\252\233\057\015\142\175\057\021\233\335\225"
	"\333\273\031\363\143\230\136\140\340\274\037\267\226\105\046\025"
	"\327\050\077\007\006\153\364\333\175\337\304\362\107\055\260\275"
	"\022\265\345\111\177\373\121\175\036\231\331\077\244\074\214\202"
	"\372\213\116\140\150\061\256\044\222\144\120\357\305\001\054\276"
	"\230\323\103\032\332\355\362\272\220\333\020\002\032\015\037\045"
	"\166\203\100\230\114\231\115\351\163\224\345\075\105\020\134\246"
	"\267\061\106\240\166\353\063\133\313\304\166\162\132\170\037\153"
	"\122\167\253\306\103\016\360\007\233\357\122\340\044\317\046\251"
	"\142\024\253\065\341\360\362\240\217\270\306\125\101\024\266\305"
	"\005\162\106\010\140\244\207\354\247\246\260\063\254\146\335\047"
	"\314\233\322\135\040\174\116\302\277\123\253\276\365\127\013\116"
	"\057\376\023\253\354\043\356\002\120\222\300\107\167\211\323\363"
	"\053\117\145\255\034\343\114\137\055\202\277\074\376\051\051\344"
	"\342\322\061\166\240\303\145\200\062\052\027\020\207\030\054\154"
	"\052\016\161\005\131\014\372\304\176\171\045\013\122\040\266\275"
	"\021\167\053\253\312\100\342\354\200\324\253\000\225\114\024\204"
	"\112\207\247\146\054\023\253\027\216\066\352\043\141\123\233\164"
	"\107\040\033\124\124\202\352\356\122\256\234\041\170\306\101\313"
	"\246\106\130\150\001\225\065\216\367\117\300\254\376\140\177\264"
	"\352\002\203\103\006\210\316\012\003\300\336\364\246\056\016\213"
	"\322\135\330\353\311\330\027\170\352\033\043\130\230\355\110\301"
	"\207\312\250\247\262\123\134\235\007\107\355\276\067\315\160\367"
	"\157\060\012\041\040\211\347\063\104\233\110\347\070\360\376\233"
	"\324\324\216\017\235\366\306\107\050\310\360\146\234\343\050\076"
	"\037\002\306\012\202\157\351\015\232\270\003\173\125\023\065\272"
	"\262\321\261\010\375\077\020\164\240\274\075\020\341\265\117\375"
	"\377\363\334\173\225\340\125\214\156\116\230\047\247\060\144\351"
	"\305\036\246\160\071\330\014\313\323\050\101\315\210\142\146\056"
	"\114\157\213\151\036\112\265\127\251\224\273\065\137\035\155\314"
	"\277\200\171\374\337\276\376\157\077\254\020\106\271\352\264\173"
	"\213\363\261\100\363\072\305\223\165\045\355\167\340\225\361\217"
	"\356\116\311\176\257\026\176\233\364\017\303\376\137\364\244\121"
	"\323\010\030\110\070\160\305\015\375\346\007\333\350\201\125\054"
	"\020\044\007\011\330\324\003\234\215\224\011\122\077\317\111\216"
	"\063\057\027\070\200\003\264\174\270\000\061\357\267\237\262\026"
	"\153\122\225\107\016\373\314\163\343\037\234\337\217\253\320\031"
	"\344\215\244\203\224\230\315\306\006\047\160\232\241\015\334\034"
	"\152\162\223\012\347\336\001\203\254\305\367\333\065\035\315\351"
	"\064\257\113\147\004\300\332\200\363\322\003\112\226\130\123\151"
	"\101\044\231\317\124\247\034\012\225\102\175\237\134\330\111\027"
	"\134\221\100\370\025\012\375\031\262\355\015\223\225\374\122\235"
	"\152\145\145\260\251\043\343\042\103\253\053\213\137\270\051\235"
	"\103\067\355\072\254\106\240\311\125\300\117\074\020\173\126\052"
	"\223\151\362\352\043\000\326\000\256\013\012\031\223\055\100\212"
	"\224\030\156\105\367\071\237\031\113\071\331\365\330\031\006\215"
	"\105\307\221\375\306\145\265\274\160\271\215\327\147\071\112\106"
	"\324\162\050\171\132\043\266\320\165\004\306\260\064\004\326\345"
	"\101\041\374\015\246\245\257\372\345\210\046\213\123\001\161\305"
	"\271\345\252\120\210\320\040\147\300\156\051\157\312\075\151\272"
	"\233\126\160\345\125\167\106\306\004\222\024\002\026\361\146\027"
	"\316\252\224\167\245\357\114\337\131\346\355\233\034\273\360\176"
	"\241\260\161\006\071\033\345\051\200\221\373\372\114\307\213\207"
	"\063\025\322\333\110\162\070\010\165\013\202\242\046\054\143\264"
	"\054\073\261\254\115\023\115\277\251\110\131\161\141\313\140\254"
	"\052\050\140\200\014\056\204\141\352\006\355\103\266\234\355\316"
	"\012\116\053\327\027\057\046\232\304\364\022\144\311\271\341\174"
	"\140\365\132\223\164\325\025\121\023\045\020\247\364\020\133\307"
	"\057\150\254\050\062\242\221\137\120\253\245\014\002\001\130\062"
	"\326\205\244\145\207\071\207\122\212\132\366\065\302\065\266\242"
	"\025\274\246\236\270\355\166\016\345\276\350\110\355\335\050\115"
	"\211\070\316\224\100\133\226\172\165\015\361\271\100\166\021\074"
	"\024\267\325\361\221\272\001\127\217\056\010\206\271\207\245\330"
	"\263\230\165\053\065\210\203\050\021\373\245\251\033\334\240\243"
	"\313\036\225\026\050\115\367\215\310\153\336\156\327\063\101\044"
	"\034\237\006\263\217\243\356\130\241\173\063\036\345\373\015\255"
	"\237\312\271\122\112\230\004\144\057\361\373\131\045\337\215\317"
	"\301\176\140\204\000\150\146\146\356\100\342\233\132\314\305\202"
	"\064\270\252\264\234\137\252\361\330\353\161\073\264\342\173\057"
	"\375\072\121\371\203\210\307\067\146\261\303\216\055\165\037\000"
	"\164\051\132\273\322\275\142\272\356\102\263\215\021\356\325\170"
	"\174\005\120\023\132\301\004\007\272\116\333\217\033\252\321\360"
	"\224\110\276\100\007\132\016\135\062\171\103\205\154\225\076\020"
	"\067\010\106\375\372\217\026\205\050\112\071\076\224\243\021\306"
	"\353\076\310\126\137\227\315\165\351\135\062\211\073\001\012\304"
	"\157\060\004\144\306\342\057\026\256\060\376\110\356\140\062\174"
	"\143\215\061\364\365\023\332\260\351\171\245\246\022\110\142\207"
	"\345\217\176\176\040\176\016\155\155\122\320\057\176\127\233\066"
	"\252\317\107\065\371\176\154\277\154\314\036\334\235\300\134\060"
	"\316\235\216\365\057\066\267\017\376\176\117\373\222\317\100\306"
	"\144\341\065\012\215\104\122\302\166\211\344\222\250\165\024\356"
	"\052\332\137\152\260\365\232\214\051\114\243\365\332\251\205\037"
	"\167\045\264\102\270\203\036\124\222\253\230\345\366\026\351\073"
	"\300\327\015\153\354\277\256\123\100\341\204\307\054\200\101\205"
	"\264\320\306\126\174\055\173\344\367\307\016\054\236\221\371\364"
	"\010\022\073\304\155\257\053\150\127\076\323\260\132\345\151\254"
	"\262\336\022\147\353\200\274\034\352\246\257\106\361\121\206\105"
	"\225\063\075\226\033\077\153\233\306\315\346\150\161\052\035\324"
	"\243\243\230\333\323\363\147\033\016\033\253\014\021\062\144\346"
	"\154\262\245\162\363\160\065\327\376\063\025\144\025\202\074\130"
	"\334\367\021\167\077\132\132\231\367\227\370\236\074\067\233\206"
	"\341\220\176\321\253\253\002\375\166\230\212\260\023\130\155\145"
	"\026\121\131\047\012\102\351\341\117\263\145\220\323\227\366\221"
	"\116\333\016\011\131\237\227\345\370\135\135\165\225\047\035\157"
	"\147\217\166\007\133\377\071\365\016\107\064\325\200\326\026\344"
	"\141\113\350\071\246\307\304\153\341\267\067\344\112\373\011\306"
	"\362\302\352\265\240\105\371\032\005\201\372\123\377\152\114\034"
	"\247\347\250\027\302\246\311\377\305\305\043\246\252\371\177\232"
	"\373\327\256\357\265\257\327\325\270\067\326\200\374\275\253\373"
	"\201\121\372\053\213\214\250\307\270\215\176\142\237\236\222\331"
	"\025\000\236\257\074\376\367\174\132\337\245\374\062\006\160\155"
	"\302\257\072\332\232\141\070\223\054\242\070\123\025\233\344\272"
	"\046\212\207\260\230\246\214\273\050\160\337\324\320\220\141\003"
	"\004\001\206\244\232\150\103\152\322\227\352\065\007\324\366\272"
	"\225\352\263\346\350\363\356\312\201\040\022\225\372\354\334\314"
	"\013\133\140\040\114\045\150\116\051\055\237\224\121\263\112\005"
	"\354\316\261\362\023\130\353\364\123\226\357\353\013\133\012\017"
	"\364\361\327\051\267\277\314\277\002\114\135\357\125\274\351\333"
	"\373\340\373\240\205\176\071\316\276\137\234\273\206\362\214\133"
	"\067\155\270\101\103\232\244\066\140\044\354\373\303\277\212\370"
	"\116\213\360\253\177\007\211\170\055\360\327\223\053\353\246\042"
	"\350\061\267\157\170\063\243\266\254\016\036\005\030\026\213\137"
	"\241\117\030\000\043\335\244\350\176\202\042\242\210\171\043\170"
	"\347\310\327\111\375\051\366\124\070\257\143\116\312\026\256\154"
	"\146\307\154\211\245\020\162\043\223\225\305\033\016\350\224\366"
	"\261\153\077\256\225\066\003\316\346\146\035\260\175\313\034\343"
	"\223\210\155\070\231\337\134\055\165\041\110\204\012\335\172\274"
	"\111\272\153\337\361\157\255\327\325\312\210\123\226\244\066\052"
	"\055\244\142\307\203\276\364\371\340\075\175\353\033\370\250\144"
	"\262\023\103\244\202\361\173\130\274\003\253\123\250\342\175\326"
	"\206\337\235\012\236\221\003\177\317\200\153\352\170\023\116\053"
	"\046\222\320\251\204\113\001\100\117\255\223\370\220\020\316\026"
	"\360\153\041\217\375\045\017\314\246\172\266\036\215\005\112\264"
	"\230\032\135\034\146\137\135\266\015\361\256\235\002\174\263\363"
	"\347\325\202\344\372\221\260\240\014\147\277\232\154\012\117\005"
	"\045\254\041\213\014\177\101\031\160\357\266\162\153\152\145\123"
	"\100\350\067\072\172\350\333\206\120\233\040\275\245\157\302\312"
	"\034\344\126\051\143\230\102\324\210\371\107\363\144\254\107\244"
	"\225\177\337\017\147\272\225\270\125\266\165\373\046\067\306\103"
	"\033\034\154\177\265\257\124\075\251\233\061\016\107\170\262\335"
	"\367\221\354\137\114\202\027\242\071\214\235\137\303\144\243\337"
	"\201\020\137\066\300\263\163\151\116\244\167\226\034\052\163\024"
	"\273\140\163\010\342\212\252\033\026\110\173\332\254\036\272\055"
	"\056\032\144\356\315\327\130\034\174\317\263\231\372\047\255\266"
	"\207\040"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
